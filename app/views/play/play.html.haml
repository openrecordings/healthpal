%div.container.fixed
  %div.row
    %div.col-sm-12
      %div
        - title = format_date @recording.created_at
        - title += " Visit with #{@recording.provider}" if @recording.provider
        %h3= title
        %h4= @recording.user.email
        %div#recording-container{data: {file: @recording.id}}
        = render partial: "player.html.haml"
        -# An alphabetized list of tags used on this recording

        - (@tags.flat_map{|x| x[1].map {|y| y.tag_type.label}}).sort.uniq.each do |tag_label|

          -#%label{for: tag_label, class: "oralfilter-#{tag_label[0..2].downcase} tag-toggle btn-tag btn", data: {tnum: tag_label}}
            = tag_label
            %input{id: tag_label, type: 'checkbox', class: 'badgebox'}
              %span.badge &check;

          - filter_html = "#{tag_label}<input class='badgebox' id='Diagnosis' type='checkbox'><span class='badge'>&check;</span></input>".html_safe
          =link_to filter_html, 'javascript:;', class: 'filter oralfilter-' + tag_label[0..2].downcase + ' tag-toggle btn-tag btn', data: {tnum: tag_label}

        %button#clear-filters Clear Filters

%table.table.table.playtabletop
  %thead
    %tr
      %th Start - Finish
      %th Tags
    %tbody
      - @tags.each do |utag|
        %tr.segment{data: {starttime: utag[0].begins_at, endtime: utag[0].ends_at}}
          %td
            = mm_ss(utag[0].begins_at, utag[0].ends_at)
          %td
            - utag[1].each do |tag|
              %div.tag{class: 'oralfilter-' + tag.tag_type&.label[0..2].downcase} #{tag.tag_type&.label}
